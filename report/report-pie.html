<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>报表统计</title>
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
    <link rel="stylesheet" type="text/css" href="../css/common.css" />
    <link rel="stylesheet" type="text/css" href="report.css" />
</head>
<body>
<section class="content2" style="background: #fff;">
    <div class="seriesChart">
        <p class="report-title">坪洲四季城店套餐订单量</p>
        <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
        <div id="main-pie"></div>
    </div>
</section>

<!-- ECharts单文件引入 -->
<!-- 引入 echarts.js -->
<script type="text/javascript" src="echarts.min.js"></script>
<!-- 引入jquery.js -->
<script type="text/javascript" src="../js/jquery-3.2.1.min.js"></script>
<script type="text/javascript">
    var myChart2 = echarts.init(document.getElementById('main-pie'),'light');
    var option2 = {
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient : 'vertical',
            x : 'left',
//            data:['15分钟/¥20','30分钟/¥40','45分钟/¥50','60分钟/¥58','单首/¥8']
        },
        calculable : true,
        series : [
            {
                name:'访问来源',
                type:'pie',
                radius : '50%',
                center: ['48%', '50%'],
//                data:[
//                    {value:335, name:'15分钟/¥20'},
//                    {value:310, name:'30分钟/¥40'},
//                    {value:234, name:'45分钟/¥50'},
//                    {value:135, name:'60分钟/¥58'},
//                    {value:1548, name:'单首/¥8'}
//                ]
            }
        ]
    };
    myChart2.showLoading();    //显示加载动画
    setAjaxChart2();
    function setAjaxChart2() {
        myChart2.showLoading();    //数据加载完之前先显示一段简单的loading动画
        var packages=[];
        $.ajax({
            type : "post",
            async : true,            //异步请求（同步请求将会锁住浏览器，用户其他操作必须等待请求完成才可以执行）
            url : "Data/equip.json",    //请求数据接口
            data : {},
            dataType : "json",        //返回数据形式为json
            success : function(dataList) {

                //请求成功时执行该函数内容，result即为服务器返回的json对象
                if (dataList) {
                    var k = dataList.list[0].packagesList.length;
                    var dataArr = [];
                    for(var j=0;j<k;j++){
                        var dataObj = {};
                        dataObj["value"]= dataList.list[0].packagesList[j].packages_value;
                        dataObj["name"]= dataList.list[0].packagesList[j].packages_name;
                        dataArr.push(dataObj);
                        packages.push(dataList.list[0].packagesList[j].packages_name);    //挨个取出类别并填入类别数组
                    }
                    option2.series[0]["data"] = dataArr;
                    option2.legend.data = packages;
                    myChart2.hideLoading();    //隐藏加载动画
                    myChart2.setOption(option2);                }
            },
            error : function(errorMsg) {
                //请求失败时执行该函数
                alert("图表请求数据失败!");
                myChart2.hideLoading();
            }
        })
    }


</script>

</body>